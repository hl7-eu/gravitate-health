@prefix fhir: <http://hl7.org/fhir/> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

# - resource -------------------------------------------------------------------

<http://hl7.eu/fhir/ig/gravitate-health/OperationDefinition/focus> a fhir:OperationDefinition ;
  fhir:nodeRole fhir:treeRoot ;
  fhir:id [ fhir:v "focus"] ; # 
  fhir:text [
     fhir:status [ fhir:v "extensions" ] ;
     fhir:div "<div xmlns=\"http://www.w3.org/1999/xhtml\"><p>URL: [base]/$focus</p><p>Parameters</p><table class=\"grid\"><tr><td><b>Use</b></td><td><b>Name</b></td><td><b>Scope</b></td><td><b>Cardinality</b></td><td><b>Type</b></td><td><b>Binding</b></td><td><b>Documentation</b></td></tr><tr><td>IN</td><td>ips</td><td/><td>0..1</td><td><a href=\"http://hl7.org/fhir/R5/datatypes.html#base64Binary\">base64Binary</a></td><td/><td><div><p>IPS bundle packaged as base64Binary in order not to mix FHIR R4 with FHIR R5.</p>\n</div></td></tr><tr><td>IN</td><td>ips-identifier</td><td/><td>0..1</td><td><a href=\"http://hl7.org/fhir/R5/datatypes.html#Identifier\">Identifier</a></td><td/><td><div><p>IPS Patient Identifier</p>\n</div></td></tr><tr><td>IN</td><td>epi</td><td/><td>0..1</td><td><a href=\"http://hl7.org/fhir/R5/bundle.html\">Bundle</a></td><td/><td><div><p>ePI Document Bundle</p>\n</div></td></tr><tr><td>IN</td><td>epi-identifier</td><td/><td>0..1</td><td><a href=\"http://hl7.org/fhir/R5/datatypes.html#Identifier\">Identifier</a></td><td/><td><div><p>ePI Document Identifier</p>\n</div></td></tr><tr><td>IN</td><td>pv</td><td/><td>0..1</td><td><a href=\"http://hl7.org/fhir/R5/bundle.html\">Bundle</a></td><td/><td><div><p>Persona Vector</p>\n</div></td></tr><tr><td>IN</td><td>pv-identifier</td><td/><td>0..1</td><td><a href=\"http://hl7.org/fhir/R5/datatypes.html#Identifier\">Identifier</a></td><td/><td><div><p>Persona Vector Identifier</p>\n</div></td></tr><tr><td>IN</td><td>language</td><td/><td>0..1</td><td><a href=\"http://hl7.org/fhir/R5/datatypes.html#Coding\">Coding</a></td><td/><td><div><p>Language of the ePI. The code must be picked from https://hl7.org/fhir/valueset-languages.html. Defaults to english if none is provided.</p>\n</div></td></tr><tr><td>OUT</td><td>returnEpi</td><td/><td>1..1</td><td><a href=\"http://hl7.org/fhir/R5/bundle.html\">Bundle</a></td><td/><td><div><p>Focused epi Bundle</p>\n</div></td></tr><tr><td>OUT</td><td>returnEpiExtracts</td><td/><td>0..1</td><td><a href=\"http://hl7.org/fhir/R5/bundle.html\">Bundle</a></td><td/><td><div><p>Focused epi Bundle extracts</p>\n</div></td></tr></table></div>"
  ] ; # 
  fhir:url [ fhir:v "http://hl7.eu/fhir/ig/gravitate-health/OperationDefinition/focus"^^xsd:anyURI] ; # 
  fhir:version [ fhir:v "0.1.0"] ; # 
  fhir:name [ fhir:v "focus"] ; # 
  fhir:title [ fhir:v "focus"] ; # 
  fhir:status [ fhir:v "active"] ; # 
  fhir:kind [ fhir:v "operation"] ; # 
  fhir:date [ fhir:v "2024-03-14T09:41:47+00:00"^^xsd:dateTime] ; # 
  fhir:publisher [ fhir:v "Gravitate Health Project"] ; # 
  fhir:contact ( [
     fhir:name [ fhir:v "Gravitate Health Project" ] ;
     fhir:telecom ( [
       fhir:system [ fhir:v "url" ] ;
       fhir:value [ fhir:v "https://www.gravitatehealth.eu/" ]
     ] )
  ] [
     fhir:name [ fhir:v "Gravitate Health Project" ] ;
     fhir:telecom ( [
       fhir:system [ fhir:v "url" ] ;
       fhir:value [ fhir:v "https://www.gravitatehealth.eu/" ]
     ] )
  ] ) ; # 
  fhir:description [ fhir:v "This operation calculates a focused version of an ePI as well as the separate extracts. The IPS can either be submitted as an IPS bundle or as an `Identifer` of the patient (using the `ips-identifier` parameter). If neither IPS Bundle or IPS identifier are passed as parameters it is expected that the `Identifier` of the patient is present as part of the security token. If the `Identifier` of the patient is submitted as an Identifier or as part of a security token it is up to the discression of the service implementing the `focus`-operation to fetch the IPS of the patient.\n\nIf the IPS is delivered as a bundle it must be encoded using Base64 as it is FHIR R4 compliant whereas the `focus`-operation is FHIR R5 compliant. The `focus`-operation will internally convert and extract the needed information from the R4 bundle.\n\nThe ePI can be delivered either as a `Bundle` or by using an `Identifier` of the bundle. Whether the support of both `Identifier` and `Bundle` continues to be supported currently remains unknown.\n\nThe persona dimension can be delivered either as a `Bundle` or by using an `Identifier` of the bundle. Whether the support of both `Identifier` and `Bundle` continues to be supported currently remains unknown.\n\n**Note: If the IPS is delivered as encoded Base64 content, there is a better opportunity for the submitting client to de-identify the Patient resource as the client can remove the Patient.identifier and mask out names and so on. While this may seem counter intuitive from an IPS point of view, the Patient identifiable components are not needed for the focusing mechanism to operate properly.**\n"] ; # 
  fhir:affectsState [ fhir:v "false"^^xsd:boolean] ; # 
  fhir:code [ fhir:v "focus"] ; # 
  fhir:system [ fhir:v "true"^^xsd:boolean] ; # 
  fhir:type [ fhir:v "false"^^xsd:boolean] ; # 
  fhir:instance [ fhir:v "false"^^xsd:boolean] ; # 
  fhir:parameter ( [
     fhir:name [ fhir:v "ips" ] ;
     fhir:use [ fhir:v "in" ] ;
     fhir:min [ fhir:v "0"^^xsd:integer ] ;
     fhir:max [ fhir:v "1" ] ;
     fhir:documentation [ fhir:v "IPS bundle packaged as base64Binary in order not to mix FHIR R4 with FHIR R5." ] ;
     fhir:type [ fhir:v "base64Binary" ]
  ] [
     fhir:name [ fhir:v "ips-identifier" ] ;
     fhir:use [ fhir:v "in" ] ;
     fhir:min [ fhir:v "0"^^xsd:integer ] ;
     fhir:max [ fhir:v "1" ] ;
     fhir:documentation [ fhir:v "IPS Patient Identifier" ] ;
     fhir:type [ fhir:v "Identifier" ]
  ] [
     fhir:name [ fhir:v "epi" ] ;
     fhir:use [ fhir:v "in" ] ;
     fhir:min [ fhir:v "0"^^xsd:integer ] ;
     fhir:max [ fhir:v "1" ] ;
     fhir:documentation [ fhir:v "ePI Document Bundle" ] ;
     fhir:type [ fhir:v "Bundle" ]
  ] [
     fhir:name [ fhir:v "epi-identifier" ] ;
     fhir:use [ fhir:v "in" ] ;
     fhir:min [ fhir:v "0"^^xsd:integer ] ;
     fhir:max [ fhir:v "1" ] ;
     fhir:documentation [ fhir:v "ePI Document Identifier" ] ;
     fhir:type [ fhir:v "Identifier" ]
  ] [
     fhir:name [ fhir:v "pv" ] ;
     fhir:use [ fhir:v "in" ] ;
     fhir:min [ fhir:v "0"^^xsd:integer ] ;
     fhir:max [ fhir:v "1" ] ;
     fhir:documentation [ fhir:v "Persona Vector" ] ;
     fhir:type [ fhir:v "Bundle" ]
  ] [
     fhir:name [ fhir:v "pv-identifier" ] ;
     fhir:use [ fhir:v "in" ] ;
     fhir:min [ fhir:v "0"^^xsd:integer ] ;
     fhir:max [ fhir:v "1" ] ;
     fhir:documentation [ fhir:v "Persona Vector Identifier" ] ;
     fhir:type [ fhir:v "Identifier" ]
  ] [
     fhir:name [ fhir:v "language" ] ;
     fhir:use [ fhir:v "in" ] ;
     fhir:min [ fhir:v "0"^^xsd:integer ] ;
     fhir:max [ fhir:v "1" ] ;
     fhir:documentation [ fhir:v "Language of the ePI. The code must be picked from https://hl7.org/fhir/valueset-languages.html. Defaults to english if none is provided." ] ;
     fhir:type [ fhir:v "Coding" ]
  ] [
     fhir:name [ fhir:v "returnEpi" ] ;
     fhir:use [ fhir:v "out" ] ;
     fhir:min [ fhir:v "1"^^xsd:integer ] ;
     fhir:max [ fhir:v "1" ] ;
     fhir:documentation [ fhir:v "Focused epi Bundle" ] ;
     fhir:type [ fhir:v "Bundle" ]
  ] [
     fhir:name [ fhir:v "returnEpiExtracts" ] ;
     fhir:use [ fhir:v "out" ] ;
     fhir:min [ fhir:v "0"^^xsd:integer ] ;
     fhir:max [ fhir:v "1" ] ;
     fhir:documentation [ fhir:v "Focused epi Bundle extracts" ] ;
     fhir:type [ fhir:v "Bundle" ]
  ] ) . # 

# -------------------------------------------------------------------------------------

